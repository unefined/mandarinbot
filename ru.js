/*
* –í—Å–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤ –¥–∞–Ω–Ω–æ–º –∫–æ–¥–µ —Å–¥–µ–ª–∞–Ω—ã–º–∏ —Ü–≤–µ—Ç–Ω—ã–º–∏ —Å –ø–æ–º–æ—â—å—é —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤ Visual Studio Code
* –î–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∏ —É–¥–æ–±–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Colorful Comments
*/

// –ò–º–ø–æ—Ä—Ç—ã
const robot = require("robotjs");
const keylogger = require("keylogger.js")
const chalk = require("chalk")
const cfg = require("./config.json")

// –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–π
let toogle = false
let oranges = 0
let buy = false
let clicker = false
let autopilot = false
/*
* –ì–æ—Ç–æ–≤—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –¥–ª—è —ç–∫—Ä–∞–Ω–æ–≤ 1920*1080
^ –ú–æ–∂–Ω–æ —Å –ª–µ–≥–∫–æ—Å—Ç—å—é —Å–æ–∑–¥–∞—Ç—å —Å–≤–æ–∏ —Å –ø–æ–º–æ—â—å—é —Ñ—É–Ω–∫—Ü–∏–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–æ—á–µ–∫
^ 1. –û—á–∏—Å—Ç–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –º–∞—Å—Å–∏–≤ –¥–æ —Ñ–æ—Ä–º—ã let arr = []
^ 2. –ó–∞–±–∏–Ω–¥–∏—Ç–µ —á–µ—Ä–µ–∑ –∫–æ–Ω—Ñ–∏–≥ –Ω—É–∂–Ω—É—é –∫–ª–∞–≤–∏—à—É –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–æ—á–µ–∫
^ 3. –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≤ –∏–≥—Ä–µ –∏–¥–∏—Ç–µ –Ω–∞ –º–∞–Ω–¥–∞—Ä–∏–Ω—ã –∏ –≤—Ö–æ–¥–∏—Ç–µ –≤ –º–µ–Ω—é —Å–±–æ—Ä–∞
& 4. –ù–∞–≤–æ–¥–∏—Ç–µ—Å—å –Ω–∞ –º–∞–Ω–¥–∞—Ä–∏–Ω –∏ –Ω–∞–∂–∏–º–∞–µ—Ç–µ –∫–ª–∞–≤–∏—à—É –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ç–æ—á–µ–∫, –ø–æ—Å–ª–µ –Ω–∞–∂–∏–º–∞–µ—Ç–µ –ª–µ–≤–æ–π –∫–ª–∞–≤–∏—à–µ–π –º—ã—à–∏ –Ω–∞ –º–∞–Ω–¥–∞—Ä–∏–Ω, —Ç–∞–∫ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç–µ —Å–æ –≤—Å–µ–º–∏ –≤ –¥–∞–Ω–Ω–æ–º –º–µ–Ω—é (–ß–ò–¢–ê–¢–¨ 5 –ü–£–ù–ö–¢)
& 5. –ù–∞ —Å–ª–µ–¥—É—é—â–∏—Ö –¥–µ—Ä–µ–≤—å—è—Ö –Ω–∞–∂–∏–º–∞–µ—Ç–µ –∫–ª–∞–≤–∏—à—É —Å–±–æ—Ä–∞, –µ—Å–ª–∏ –µ—Å—Ç—å –º–∞–Ω–¥–∞—Ä–∏–Ω—ã –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ —Å–æ–±—Ä–∞–ª–∏—Å—å —Ç–æ —Å–æ–±–∏—Ä–∞–µ—Ç–µ –∏—Ö –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç–µ —á–µ—Ä–µ–∑ –∫–ª–∞–≤–∏—à—É —Å–±–æ—Ä–∞
TODO 6. –ì–æ—Ç–æ–≤–æ! –í—ã –º–æ–∂–µ—Ç–µ –±—ã—Å—Ç—Ä–æ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–≤–µ—Å—Ç—ã/–∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã/–∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –º–∞–Ω–¥–∞—Ä–∏–Ω–∞—Ö, —É–¥–∞—á–∏!
*/
let arr = [
    [833, 353], [923, 418], [1167, 358],
    [1015, 127], [924, 127], [828, 141],
    [756, 222], [986, 272], [1105, 174],
    [1044, 471], [754, 583], [918, 523],
    [890, 629], [987, 604], [1084, 576],
    [1047, 381], [874, 258], [716, 346],
    [1175, 461], [1174, 572], [808, 431],
    [979, 695], [798, 697], [1166, 256],
    [831, 141], [1128, 697], [923, 126],
    [758, 224], [1108, 173], [1160, 356],
    [1014, 127], [874, 261], [719, 345],
    [888, 632], [918, 518], [1051, 383],
    [823, 349], [1079, 478]
]

// ^ –õ–æ–≥–æ + —Å–ø–∏—Å–æ–∫ —Ñ—É–Ω–∫—Ü–∏–π
function clearterminal() {
    process.stdout.write("\u001b[2J\u001b[0;0H");
    console.log(chalk.green(chalk.bold(`

                                                
    _         _        _       _   
    _____ ___ ___ _| |___ ___|_|___   | |_ ___| |_ 
   |     | .'|   | . | .'|  _| |   |  | . | . |  _|
   |_|_|_|__,|_|_|___|__,|_| |_|_|_|  |___|___|_|  
                                                   

by unefined
https://github.com/unefined`)))

console.log(`
üçä ${cfg.collectmandarin} - –°–±–æ—Ä –º–∞–Ω–¥–∞—Ä–∏–Ω–æ–≤                    | ‚úÖ ${cfg.collectmandarin}
üçä ${cfg.newpoint} - –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ç–æ—á–∫—É –º–∞–Ω–¥–∞—Ä–∏–Ω–æ–≤     | ‚úÖ ${cfg.newpoint}
üîÆ F5 - –í–∫–ª—é—á–∏—Ç—å/–í—ã–∫–ª—é—á–∏—Ç—å —Å–∫—Ä–∏–ø—Ç           | ${toogle == true ? "üî¥ –í—ã–∫–ª—é—á–µ–Ω–æ" : "‚úÖ –í–∫–ª—é—á–µ–Ω–æ"}
üîê –ü—Ä–∏—Å—Ç–µ–≥–∏–≤–∞–Ω–∏–µ —Ä–µ–º–Ω—è –±–µ–∑–æ–ø–∞—Å—Ç–Ω–æ—Å—Ç–∏        | ‚úÖ –í–∫–ª—é—á–µ–Ω–æ (–ö–æ–Ω—Ñ–∏–≥)
üöò ${cfg.autopilot} - –ê–≤—Ç–æ–ø–∏–ª–æ—Ç ( –ó–∞–∂–∏–º–∞–µ—Ç W )             | ${autopilot == false ? "üî¥ –í—ã–∫–ª—é—á–µ–Ω–æ" : "‚úÖ –í–∫–ª—é—á–µ–Ω–æ"}
üçí ${cfg.multibuy} - –ú—É–ª—å—Ç–∏ –ø–æ–∫—É–ø–∫–∞ (–ú–∞–≥–∞–∑–∏–Ω 24/7)       | ${buy == false ? "üî¥ –í—ã–∫–ª—é—á–µ–Ω–æ" : "‚úÖ –í–∫–ª—é—á–µ–Ω–æ"}
üß≥ ${cfg.clicker} - –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–≥–∞–∂–Ω–∏–∫–∞ / –ö–ª–∏–∫–µ—Ä         | ${clicker == false ? "üî¥ –í—ã–∫–ª—é—á–µ–Ω–æ" : "‚úÖ –í–∫–ª—é—á–µ–Ω–æ"}
`)
}

// & –§—É–Ω–∫—Ü–∏—è –¥–ª—è —Å–±–æ—Ä–∞ –º–∞–Ω–¥–∞—Ä–∏–Ω–æ–≤
function collecting(arr) {
    arr.forEach(a => {
        robot.moveMouse(a[0], a[1])
        robot.mouseClick()
    })
}

// * –û—á–∏—â–∞–µ–º —Ç–µ—Ä–º–∏–Ω–∞–ª –∏ –≤—ã–≤–æ–¥–∏–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
clearterminal()

keylogger.start((key, isKeyUp, keyCode) => {

    // & –°–±–æ—Ä –º–∞–Ω–¥–∞—Ä–∏–Ω–æ–≤

    if (key == cfg.collectmandarin && isKeyUp == true) {
        if (toogle == true) return
        collecting(arr)
        oranges++
        clearterminal()
        console.log(chalk.bold(chalk.yellow("üçä –°–æ–±—Ä–∞–Ω –∞–ø–µ–ª—å—Å–∏–Ω. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞ —Å–µ—Å—Å–∏—é: " + oranges + " | –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ: " + oranges * 22 + "$")))
    }

    // & –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö —Ç–æ—á–µ–∫ –≤ –º–∞—Å—Å–∏–≤

    if (key == cfg.newpoint && isKeyUp == true) {
        if (toogle == true) return
        let mouse = robot.getMousePos();
        let hex = robot.getPixelColor(mouse.x, mouse.y);
        console.log(chalk.bold(chalk.green("#" + hex + " at x:" + mouse.x + " y:" + mouse.y)))
        arr.push([mouse.x, mouse.y])
        // ! –ù–∏–∂–Ω–∏–π –∫–æ–¥ –æ—á–µ–Ω—å –ø–æ–ª–µ–∑–µ–Ω –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤—ã—Ö —Ç–æ—á–µ–∫
        // console.log(arr)
        
    }

    // & –í–∫–ª—é—á–µ–Ω–∏–µ/–í—ã–∫–ª—é—á–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞

    if (key == "F5" && isKeyUp == true) {
        if (toogle == false) {
            toogle = true
            clearterminal()
            console.log(chalk.red("üß• –°–∫—Ä–∏–ø—Ç –≤—ã–∫–ª—é—á–µ–Ω"))
        } else {
            toogle = false
            clearterminal()
            console.log(chalk.green("üëî –°–∫—Ä–∏–ø—Ç –≤–∫–ª—é—á–µ–Ω"))
        }
    }

    // & –ú—É–ª—å—Ç–∏-–ü–æ–∫—É–ø–∫–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–∞—Ö 24/7

    if (key == cfg.multibuy && isKeyUp == true) {
        if (toogle == true) return
        if (buy == false) {
            buy = true
            clearterminal()
            console.log(chalk.bold(chalk.green("üçí –ú—É–ª—å—Ç–∏-–ü–æ–∫—É–ø–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞")))
            setInterval(() => {
                if (toogle == true) return
                if (buy == false) return
                robot.mouseClick()
            }, 600);
        } else {
            buy = false
            clearterminal()
            console.log(chalk.bold(chalk.red("üçí –ú—É–ª—å—Ç–∏-–ü–æ–∫—É–ø–∫–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞")))
        }
    }

    // & –ü–æ—á—Ç–∏ —Ç–æ–∂–µ —Å–∞–º–æ–µ –∫–∞–∫ –ø—Ä–æ—à–ª–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–æ —Å 64 cps (clicks per second)
    // * –ï–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–∏–∫–∞–∫ –Ω–µ –º–µ—à–∞–µ—Ç –ø—Ä–∏ —Ö–æ–¥—å–±–µ –≤ –∏–≥—Ä–µ

    if (key == cfg.clicker && isKeyUp == true) {
        if (toogle == true) return
        if (clicker == false) {
            clicker = true
            clearterminal()
            console.log(chalk.bold(chalk.green("üß≥ –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–≥–∞–∂–Ω–∏–∫–∞ –≤–∫–ª—é—á–µ–Ω–∞")))
            setInterval(() => {
                if (toogle == true) return
                if (clicker == false) return
                robot.mouseClick()
            }, 1);
        } else {
            clicker = false
            clearterminal()
            console.log(chalk.bold(chalk.red("üß≥ –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–≥–∞–∂–Ω–∏–∫–∞ –≤—ã–∫–ª—é—á–µ–Ω–∞")))
        }
    }

    // & –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–º–Ω—è –±–µ–∑–æ–ø–∞—Å—Ç–Ω–æ—Å—Ç–∏
    // * –°–¥–µ–ª–∞–Ω–æ –∫—Ä–∏–≤–æ, –Ω–∞–¥–æ –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å

    if (key == "F" && isKeyUp == true) { // –†–µ–º–µ–Ω—å –±–µ–∑–æ–ø–∞—Å—Ç–Ω–æ—Å—Ç–∏
        if (toogle == true) return
        if (cfg.safebelt == false) return
        setTimeout(() => {
            robot.keyTap("J")
            console.log(chalk.bold(chalk.green("‚ú® –†–µ–º–µ–Ω—å –±–µ–∑–æ–ø–∞—Å—Ç–Ω–æ—Å—Ç–∏ –±—ã–ª –ø—Ä–∏—Å—Ç–µ–≥–Ω—É—Ç")))
        }, 3000)
    }

    // & –ó–∞–∂–∏–º–∞–µ—Ç –∫–ª–∞–≤–∏—à—É W
    // * –ü–æ–ª–µ–∑–Ω–æ –¥–ª—è –º–∞—à–∏–Ω –∫–æ—Ç–æ—Ä—ã–µ –µ–¥—É—Ç –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ

    if (key == "M" && isKeyUp == true) { // –ê–≤—Ç–æ–ø–∏–ª–æ—Ç
        if(toogle == true) return
        if(autopilot == true)  {
            robot.keyToggle("w", "up"); 
            autopilot = false; 
            clearterminal()
            console.log(chalk.bold(chalk.red("üöò –ê–≤—Ç–æ–ø–∏–ª–æ—Ç –≤—ã–∫–ª—é—á–µ–Ω [ –ï–°–õ–ò –ù–ï –í–´–ö–õ–Æ–ß–ê–ï–¢–¨–°–Ø –ù–ê–ñ–ú–ò–¢–ï W ]")));
            return
        }
        if(autopilot == false) {
            robot.keyToggle("w", "down"); 
            autopilot = true; 
            clearterminal()
            console.log(chalk.bold(chalk.green("üöò –ê–≤—Ç–æ–ø–∏–ª–æ—Ç –≤–∫–ª—é—á–µ–Ω")));
            return
        }
    }
})

// * –°–∫—Ä–∏–ø—Ç –±—É–¥–µ—Ç –¥–æ—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å—Å—è, —Å—Ç–∞–≤—å—Ç–µ –∑–≤–µ–∑–¥–æ—á–∫–∏ –Ω–∞ –º–æ–µ–º –≥–∏—Ç—Ö–∞–±–µ